import subprocess
import os

# Function to handle Hydra exploit
def hydra_attack(ip, username, password_list):
    try:
        wordlist_path = os.path.join(os.path.dirname(__file__), 'wordlists', password_list)
        cmd = f'hydra -l {username} -P {wordlist_path} -t 1 -e ns -o hydra.txt ssh://{ip}'
        subprocess.run(cmd, shell=True)
        with open('hydra.txt', 'r') as f:
            hydra_output = f.read()
        issues_found = hydra_output
        return {"issues_found": issues_found}  # Ajout de la cl√© "issues_found"
    except Exception as e:
        print(f"Error during Hydra attack: {e}")
        return {}

# Function to handle SQLMap exploit
def sqlmap_exploit(target):
    result_file = "sqlmap_result.txt"
    with open(result_file, "w") as output_file:
        subprocess.run(["sqlmap", target, "--crawl=2", "--batch", "-o", result_file], stdout=output_file, stderr=subprocess.PIPE)
    
    with open(result_file, "r") as result_file:
        sqlmap_output = result_file.read()
    
    return sqlmap_output

